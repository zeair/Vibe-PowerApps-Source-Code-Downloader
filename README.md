# Vibe PowerApps Source Code Downloader

Chrome extension for downloading source code files and folder structures from vibe.powerapps.com.

<img width="372" height="123" alt="image" src="https://github.com/user-attachments/assets/5271a26a-740c-4519-b4ff-9be365865267" />



<img width="594" height="757" alt="image" src="https://github.com/user-attachments/assets/010da8f5-b506-40c9-865e-f000ca22b048" />




## Disclaimer

This extension was automatically generated by Claude AI (Anthropic). I am not responsible for any issues, bugs, or consequences arising from its use. Use at your own risk.

## Features

- **Download individual files**: Click the extension icon or use `Ctrl+Shift+D` / `Cmd+Shift+D` to download the currently open file
- **Visual download tracking**: Downloaded files are marked with a green checkmark (✓) in the file tree panel
- **Session-based markers**: Download markers are visible during current session only (cleared on page reload)
- **Keyboard shortcuts**: Quick access with `Ctrl+Shift+D` (file) and `Ctrl+Shift+T` (tree structure)
- **Download folder structure**: Right-click the extension icon or use `Ctrl+Shift+T` / `Cmd+Shift+T` to download the entire project folder structure as JSON
- **Auto-detect file types**: Supports tsx, ts, jsx, js, css, html, json, md, yml, yaml, xml, txt, svg
- **Preserve folder hierarchy**: Downloaded JSON includes complete folder tree structure

## Installation

1. Download or clone this repository
2. Open Chrome and go to `chrome://extensions/`
3. Enable "Developer mode" (toggle in top right corner)
4. Click "Load unpacked"
5. Select the folder containing this extension

## Keyboard Shortcuts

The extension comes with default keyboard shortcuts:
- **Download current file**: `Ctrl+Shift+D` (Windows/Linux) or `Cmd+Shift+D` (Mac)
- **Download folder structure**: `Ctrl+Shift+T` (Windows/Linux) or `Cmd+Shift+T` (Mac)

### Customizing Shortcuts

1. Go to `chrome://extensions/shortcuts`
2. Find "Vibe PowerApps Source Code Downloader"
3. Click the edit icon next to each command
4. Set your preferred keyboard shortcuts

## Usage

### Download Current File

**Method 1: Click extension icon**
1. Navigate to vibe.powerapps.com and open any file in the Monaco editor
2. Click the Vibe PowerApps extension icon in your Chrome toolbar
3. The file will download automatically with the correct filename and extension
4. The file will be marked with a green checkmark (✓) in the file tree panel
5. Downloaded file markers are cleared when you reload the page

**Method 2: Use keyboard shortcut**
- Press `Ctrl+Shift+D` (Windows/Linux) or `Cmd+Shift+D` (Mac) to download the current file

### Download Folder Structure

**IMPORTANT: Before downloading the folder structure:**
1. **Expand ALL folders** in the file tree sidebar on the left
2. Make sure the entire project structure is visible (all folders opened)
3. This ensures the JSON will contain the complete folder hierarchy

**Method 1: Right-click extension icon**
1. Navigate to vibe.powerapps.com with your project open
2. **Expand all folders in the file tree** (click the arrow icons to open all nested folders)
3. Right-click the Vibe PowerApps extension icon in your Chrome toolbar
4. Select "Download folder structure from Vibe PowerApps"
5. A JSON file will download with format: `vibe.powerapps.[plan-id].json`
6. The JSON contains the complete folder hierarchy

**Method 2: Use keyboard shortcut**
1. **Expand all folders in the file tree** first
2. Press `Ctrl+Shift+T` (Windows/Linux) or `Cmd+Shift+T` (Mac) to download the folder structure

## Example Folder Structure JSON

```json
[
  {
    "name": "src",
    "type": "folder",
    "children": [
      {
        "name": "components",
        "type": "folder",
        "children": [
          {
            "name": "Button.tsx",
            "type": "file"
          }
        ]
      },
      {
        "name": "index.tsx",
        "type": "file"
      }
    ]
  }
]
```

## How It Works

### File Download
1. Extension injects a content script into the page
2. Script extracts code from Monaco Editor using scroll-based extraction for complete file content
3. Script finds filename by looking for text above the Monaco editor
4. Background script receives the content and filename
5. File is downloaded with correct MIME type
6. Content script marks the file with a green checkmark (✓) in the tree panel
7. Downloaded file markers are session-based (cleared on page reload)

### Folder Structure Download
1. Extension extracts the file tree from Fluent UI TreeItem elements (`.fui-TreeItem`)
2. Builds hierarchical structure based on `aria-level` attributes
3. Identifies folders vs files using `aria-expanded` attribute
4. Extracts plan ID from URL (`/plan/[id]`)
5. Downloads as JSON with plan ID in filename

## Supported File Types

- TypeScript: `.ts`, `.tsx`
- JavaScript: `.js`, `.jsx`
- Stylesheets: `.css`
- Markup: `.html`, `.xml`
- Data: `.json`, `.yml`, `.yaml`
- Documentation: `.md`, `.txt`
- Images: `.svg`

## Files

- `manifest.json` - Extension configuration
- `background.js` - Handles downloads and context menu
- `content.js` - Extracts code and folder structure from page
- `icon16.png`, `icon48.png`, `icon128.png` - Extension icons
- `README.md` - This file
- `Agent.md` - Instructions for reconstructing project structure
- `reconstruct.py` - Python script to reconstruct folder structure
- `reconstruct.js` - Node.js script to reconstruct folder structure

## Permissions

- `downloads` - Required to download files
- `activeTab` - Required to access current tab content
- `scripting` - Required to inject content script
- `contextMenus` - Required for right-click menu
- Host permission for `https://vibe.powerapps.com/*`

## Troubleshooting

### Extension icon doesn't appear
- Make sure you're on vibe.powerapps.com
- Reload the extension in chrome://extensions/

### Download shows "download.txt" instead of correct filename
- Make sure the file is open in Monaco editor
- Check browser console for "Found filename" messages
- The filename must be visible above the Monaco editor

### "Could not establish connection" error
- Reload the page
- Try clicking the extension icon again
- Check that the extension has proper permissions

### Folder structure is empty
- Make sure the file tree sidebar is visible
- Expand some folders before downloading
- Check that elements with class `.fui-TreeItem` exist on page

### Download markers don't appear
- Check browser console for "Marked as downloaded" messages
- Make sure the file tree sidebar is visible
- Markers are session-based - they will disappear after page reload

### Want to clear download markers
- Simply reload the page - markers are not persisted

## Reconstructing Project Structure

After downloading files and folder structure, you can reconstruct the complete project with proper folder hierarchy.

### Option 1: Using AI Agent (Recommended)

See [Agent.md](Agent.md) for detailed instructions on how to use an AI coding assistant (like Claude) to automatically reconstruct your project structure.

**Quick steps:**
1. Download individual files (they go to your Downloads folder)
2. Download folder structure JSON (right-click extension icon)
3. Move all files to a folder like `DOWNLOADED_SOURCE_FILES/`
4. Use one of these methods to reconstruct:

**Method A: Run the included Python script:**
```bash
python3 reconstruct.py
```
The script will:
- Create folder hierarchy from JSON
- Copy files to correct locations
- Report missing files (in JSON but not downloaded)
- Warn about unused files (downloaded but not in JSON)

**Method B: Run the included Node.js script:**
```bash
node reconstruct.js
```
Same functionality as Python script.

**Method C: Ask your AI assistant:**
```
I have files in ./DOWNLOADED_SOURCE_FILES/ and structure in ./DOWNLOADED_SOURCE_FILES/vibe.powerapps.[id].json
Please reconstruct the project in ./GENERATED_SOURCE_CODE_STRUCTURE/
```

### Option 2: Manual Reconstruction

1. Open the downloaded JSON file
2. Create folders according to the structure
3. Move each downloaded file to its correct location based on the JSON

## Workflow Example

1. **Download files**: Click extension icon for each file you want to save
2. **Download structure**: Right-click extension icon → "Download folder structure"
3. **Organize**: Use one of the reconstruction methods above
4. **Result**: Complete project with proper folder hierarchy

```
Before (flat):
DOWNLOADED_SOURCE_FILES/
├── accordion.tsx
├── alert-dialog.tsx
├── alert.tsx
├── app-plan.md
├── design.md
├── error-boundary.tsx
└── vibe.powerapps.[id].json

After (reconstructed):
GENERATED_SOURCE_CODE_STRUCTURE/
├── docs/
│   ├── app-plan.md
│   └── design.md
└── src/
    ├── components/
    │   ├── system/
    │   │   └── error-boundary.tsx
    │   └── ui/
    │       ├── accordion.tsx
    │       ├── alert-dialog.tsx
    │       └── alert.tsx
    └── ...
```

## Version

1.0 - Initial release

## Generated By

Claude AI (Anthropic) - December 2024

## License

This code is provided as-is without any warranty. Use at your own risk.
